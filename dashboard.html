<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap CSS and other links -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">

  <style>
    /* Styles from the provided code and adjustments for dash.html */

    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f9;
      color: #333;
      margin: 0;
      padding: 0;
    }

    nav.navbar {
      background-color: #1e1e2f;
    }

    nav.navbar .navbar-brand img {
      max-width: 80px;
    }

    nav.navbar a.nav-link,
    nav.navbar a.navbar-brand {
      color: #f4f4f9;
      font-weight: bold;
    }

    nav.navbar a.nav-link:hover {
      color: #00b4d8;
    }

    .navbar-toggler {
      border: none;
    }

    .navbar-toggler-icon {
      background-color: white;
    }

    .btn-light {
      background-color: #00b4d8;
      color: #fff;
      border: none;
    }

    /* Hero Section with Video Background */
    section#hero {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-align: center;
      overflow: hidden;
      height: 100vh;
    }

    section#hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }

    #hero video {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      min-width: 100%;
      min-height: 100%;
      z-index: 0;
      object-fit: cover;
    }

    .hero-content {
      position: relative;
      z-index: 2;
    }

    /* Features Section */
    section#features {
      padding: 60px 0;
    }

    section#features h2 {
      color: #004bf8;
      margin-bottom: 40px;
    }

    .feature-block {
      text-align: center;
      border: none;
      border-radius: 15px;
      overflow: hidden;
      transition: transform 0.3s ease;
      background-color: #fff;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }

    .feature-block:hover {
      transform: translateY(-10px);
    }

    .feature-image img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .feature-details {
      padding: 20px;
    }

    /* Chatbot Styles */
    .chatbot-container {
      border-radius: 10px;
      background-color: #fff;
      color: #333;
      width: 350px;
      position: fixed;
      bottom: 25px;
      right: 80px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      display: none;
    }

    .chat-header {
      background-color: #00b4d8;
      color: #fff;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .close-btn {
      cursor: pointer;
      font-size: 20px;
    }

    .chat-body {
      background-color: #fff;
      height: 300px;
      overflow-y: auto;
      padding: 10px;
    }

    .chat-messages {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .chat {
      display: flex;
      margin-bottom: 10px;
    }

    .outgoing {
      justify-content: flex-end;
    }

    .outgoing p {
      background-color: #00b4d8;
      color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      max-width: 70%;
    }

    .incoming {
      justify-content: flex-start;
    }

    .incoming p {
      background-color: #f0f0f0;
      padding: 8px 12px;
      border-radius: 8px;
      max-width: 70%;
    }

    .chat-footer {
      display: flex;
      padding: 10px;
      border-top: 1px solid #ddd;
    }

    #user-message {
      flex: 1;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-right: 5px;
    }

    #send-btn {
      padding: 8px 12px;
      background-color: #00b4d8;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    /* FAQ Section */
    #faq {
      background: #1e1e2f;
      color: white;
      padding: 60px 0;
    }

    .accordion .card-header {
      background: #00b4d8;
      color: white;
    }

    /* Footer */
    footer {
      background-color: #1e1e2f;
      color: white;
      text-align: center;
      padding: 20px 0;
    }
    .button {
      display: inline-block;
      padding: 15px 30px;
      background-color: #f0b90b;
      color: #14213d;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }
    
    .button:hover {
      background-color: #ffc107;
    }
    
    .section2 {
      background-color: #1e1e2f;
      text-align: center;
      padding: 50px 0;
    }
    
    .section2 h2 {
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    
    .section2 p {
      color:white;
      font-size: 18px;
      font-weight: bold;
      line-height: 1.5;
      margin-bottom: 30px;
    }
    
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
    }
    
    .feature-block {
      text-align: center;
      border: 2px solid white;
      border-radius: 15px;
      overflow: hidden;
      flex-basis: 300px;
      width: 300px;
      transition: transform 0.3s ease;
      background-color: #ffffff12;
    }
    
    .feature-block:hover {
      transform: translateY(-10px);
    }
    
    .feature-image img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }
    
    .feature-details {
      padding: 20px;
      color: aqua;
    }
    
    .feature-details h3 {
      font-size: 24px;
      margin-bottom: 10px;
    }
    
    .feature-details p {
      font-size: 16px;
      line-height: 1.5;
    }
    .toggle-btn {
      padding: 10px 20px;
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      position: fixed;
      bottom: 25px;
      right: 10px;
    }
    
    .toggle-btn:hover {
      background-color: #0056b3;
    }
    
    .chatbot-container {
      width: 350px;
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      position: fixed;
      bottom: 25px;
      right: 80px;
    }
    
    .chat-header {
      background-color: #007bff;
      color: #fff;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .close-btn {
      cursor: pointer;
      font-size: 20px;
    }
    
    .chat-body {
      background-color: #fff;
      height: 300px;
      overflow-y: auto;
      padding: 10px;
    }
    
    .chat-messages {
      list-style: none;
      padding: 0;
      margin: 0;
      color:black
    }
    
    .chat {
      display: flex;
      margin-bottom: 10px;
    }
    
    .outgoing {
      justify-content: flex-end;
    }
    
    .outgoing p {
      background-color: #007bff;
      color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      max-width: 70%;
    }
    
    .incoming {
      justify-content: flex-start;
    }
    
    .incoming p {
      background-color: #f0f0f0;
      padding: 8px 12px;
      border-radius: 8px;
      max-width: 70%;
    }
    
    .recommended-topics {
      margin-top: 10px;
    }
    
    .recommended-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color:black;
    }
    
    .refresh-icon {
      cursor: pointer;
      background: none;
      border: none;
      font-size: 18px;
      color: #007bff;
      padding: 0;
    }
    
    .refresh-icon:hover {
      color: #0056b3;
    }
    
    #recommended-questions {
      list-style: none;
      padding: 0;
      margin: 5px 0 0;
      color: black;;
    }
    
    #recommended-questions li {
      padding: 8px;
      margin: 5px 0;
      cursor: pointer;
      background-color: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    #recommended-questions li:hover {
      background-color: #e9ecef;
    }
    
    .chat-footer {
      display: flex;
      padding: 10px;
      border-top: 1px solid #ddd;
    }
    
    #user-message {
      flex: 1;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-right: 5px;
    }
    
    #send-btn {
      padding: 8px 12px;
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    
    #send-btn:hover {
      background-color: #0056b3;
    }
    /* Additional styles */
    /* ... */

  </style>
</head>
<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="dashboard.html">
      <img src="apsit.png" alt="APSIT Logo">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="solutionsDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            Solutions
          </a>
          <div class="dropdown-menu" aria-labelledby="solutionsDropdown">
            <a class="dropdown-item" href="#">Overview</a>
            <a class="dropdown-item" href="#">IndoorMaps</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="resourcesDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            Resources
          </a>
          <div class="dropdown-menu" aria-labelledby="resourcesDropdown">
            <a class="dropdown-item" href="#" onclick="scrollToFaq()">FAQ</a>
            <a class="dropdown-item" href="#">Community</a>
            <a class="dropdown-item" href="#">Tutorials</a>
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="signin.html" id="profile-btn">Student Login</a>
          <a class="nav-link" href="#" id="logout-btn" style="display: none;" onclick="logout()">Logout</a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Hero Section with Video Background -->
  <section id="hero">
    <video autoplay muted loop>
      <source src="homepage.mp4" type="video/mp4">
      Your browser does not support HTML5 video.
    </video>
    <div class="hero-content">
      <h1>AR APSIT</h1>
      <p>Revolutionizing navigation within APSIT using AR technology</p>
      <a href="#" class="btn btn-light mt-4" onclick="scrollToFeatures()">Get Started</a>
    </div>
  </section>

  <!-- Features Section -->
  <section class="section2" id="features">
    <h2>Our Features</h2>
    <p>We offer a wide range of features to enhance your indoor experience.</p>

    <div class="container">
      <!-- AR Navigation feature available to all -->
      <a href="ar://" class="feature-block">
        <div class="feature-image">
          <img src="ar.png" alt="ar">
        </div>
        <div class="feature-details">
          <h3>AR NAVIGATION</h3>
          <p>The AR Navigation System is designed to enhance navigation within the college premises.</p>
        </div>
      </a>

      <!-- APSIT-Wiki link shown only to authenticated users -->
      <div id="wiki-feature" class="feature-block" style="display: none;">
        <a href="https://apsitwiki.onrender.com" target="_blank" id="wiki-link">
          <div class="feature-image">
            <img src="bookicon.png" alt="apsitwiki">
          </div>
          <div class="feature-details">
            <h3>APSIT-WIKI</h3>
            <p>APSITwiki is an online platform dedicated to providing academic resources for APSIT students.</p>
          </div>
        </a>
      </div>
    </div>
<div class="c_container">
      <button id="chatbot-toggler" class="btn btn-primary rounded-circle shadow">
        <span class="material-symbols-outlined">
          smart_toy
          </span>
      </button>
      
      <div class="chatbot-container" id="chatbot-container">
          <div class="chat-header">
              <h2>Smart Assistant</h2>
              <span class="close-btn" id="close-btn">&times;</span>
          </div>
          
          <div class="chat-body">
              <ul id="chatbox" class="chat-messages"></ul>
          </div>

          <!-- Recommended Topics Section -->
          <div class="recommended-topics">
              <h4>Recommended Topics</h4>
              <ul id="topic-list" class="topic-list"></ul>
              <button id="refresh-btn" class="btn btn-secondary">Refresh Topics</button>
          </div>

          <div class="chat-footer">
              <input type="text" id="user-message" class="form-control" placeholder="Type your question..." />
              <button id="send-btn" class="btn btn-success">
                  <span class="material-symbols-outlined">Send</span>
              </button>
          </div>
      </div>
  </div>
  </section>    

<footer class="footer bg-dark text-white py-5">
  <div class="container">
    <h2 class="text-center font-weight-bold mb-5" style="color: #f8f9fa;">Frequently Asked Questions</h2>

    <div class="accordion" id="faqAccordion">
      <!-- FAQ 1 -->
      <div class="card mb-3">
        <div class="card-header p-0" id="headingOne" style="border-left: 4px solid #007bff; background-color: #f1f1f1;">
          <h3 class="mb-0">
            <button class="btn btn-link btn-block text-left text-dark font-weight-bold py-3 px-4 collapsed" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne" style="text-decoration: none;">
              Q1: What is the AR-APSIT navigation system?
            </button>
          </h3>
        </div>
        <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#faqAccordion">
          <div class="card-body text-light" style="background-color: #495057;">
            A1: The AR-APSIT navigation system is an augmented reality solution designed to enhance navigation experiences in various environments, including urban areas, indoor spaces, and outdoor settings. It provides real-time directions and information overlaid onto the user's view.
          </div>
        </div>
      </div>

      <!-- FAQ 2 -->
      <div class="card mb-3">
        <div class="card-header p-0" id="headingTwo" style="border-left: 4px solid #007bff; background-color: #f1f1f1;">
          <h3 class="mb-0">
            <button class="btn btn-link btn-block text-left text-dark font-weight-bold py-3 px-4 collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="text-decoration: none;">
              Q2: How does the AR-APSIT navigation system work?
            </button>
          </h3>
        </div>
        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#faqAccordion">
          <div class="card-body text-light" style="background-color: #495057;">
            A2: The system uses a combination of GPS, sensors, and augmented reality technology to provide navigation instructions. Users can view directions on their device screens, which are overlaid onto their real-world surroundings.
          </div>
        </div>
      </div>

      <!-- FAQ 3 -->
      <div class="card mb-3">
        <div class="card-header p-0" id="headingThree" style="border-left: 4px solid #007bff; background-color: #f1f1f1;">
          <h3 class="mb-0">
            <button class="btn btn-link btn-block text-left text-dark font-weight-bold py-3 px-4 collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree" style="text-decoration: none;">
              Q3: Do I need an internet connection to use the AR-APSIT navigation system?
            </button>
          </h3>
        </div>
        <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#faqAccordion">
          <div class="card-body text-light" style="background-color: #495057;">
            A3: While an internet connection is helpful for real-time data and updates, the system can function with pre-downloaded maps and data, allowing offline navigation in limited scenarios.
          </div>
        </div>
      </div>

      <!-- FAQ 4 -->
      <div class="card mb-3">
        <div class="card-header p-0" id="headingFour" style="border-left: 4px solid #007bff; background-color: #f1f1f1;">
          <h3 class="mb-0">
            <button class="btn btn-link btn-block text-left text-dark font-weight-bold py-3 px-4 collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour" style="text-decoration: none;">
              Q4: Can I use the AR-APSIT navigation system for indoor navigation?
            </button>
          </h3>
        </div>
        <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#faqAccordion">
          <div class="card-body text-light" style="background-color: #495057;">
            A4: Yes, the AR-APSIT system is designed for both indoor and outdoor navigation, utilizing augmented reality to help users find their way in complex indoor environments like malls, airports, and museums.
          </div>
        </div>
      </div>

      <!-- FAQ 5 -->
      <div class="card mb-3">
        <div class="card-header p-0" id="headingFive" style="border-left: 4px solid #007bff; background-color: #f1f1f1;">
          <h3 class="mb-0">
            <button class="btn btn-link btn-block text-left text-dark font-weight-bold py-3 px-4 collapsed" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive" style="text-decoration: none;">
              Q5: How can I provide feedback or report an issue with the AR-APSIT system?
            </button>
          </h3>
        </div>
        <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#faqAccordion">
          <div class="card-body text-light" style="background-color: #495057;">
            A5: Users can provide feedback or report issues through the app's feedback section or by contacting customer support directly. We appreciate your input to help improve the system!
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Bootstrap JS and dependencies -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


  <!-- Feedback Form -->
  <div class="container my-5">
    <div class="feedback-container">
      <h3>We value your feedback!</h3>
      <form id="feedback-form">
        <div class="form-group">
          <label for="name">Your Name:</label>
          <input type="text" id="name" name="name" placeholder="Enter your name" required class="form-control">
        </div>
        <div class="form-group">
          <label for="email">Your Email:</label>
          <input type="email" id="email" name="email" placeholder="Enter your email" required class="form-control">
        </div>
        <div class="form-group">
          <label for="feedback-type">Type of Feedback:</label>
          <select id="feedback-type" name="feedback-type" required class="form-control">
            <option value="">Select feedback type</option>
            <option value="Suggestion">Suggestion</option>
            <option value="Complaint">Complaint</option>
            <option value="Compliment">Compliment</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div class="form-group">
          <label for="feedback">Your Feedback:</label>
          <textarea id="feedback" name="feedback" rows="4" placeholder="Enter your feedback..." required class="form-control"></textarea>
        </div>
        <div class="form-group">
          <label for="rating">Rate your experience:</label>
          <select id="rating" name="rating" required class="form-control">
            <option value="">Select a rating</option>
            <option value="1">1 - Poor</option>
            <option value="2">2 - Fair</option>
            <option value="3">3 - Good</option>
            <option value="4">4 - Very Good</option>
            <option value="5">5 - Excellent</option>
          </select>
        </div>
        <button type="submit" class="btn btn-primary submit-btn">Submit Feedback</button>
      </form>
      <div id="feedback-message"></div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <p>&copy; 2024 AR-APSIT.ai All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <script>
   // Check if the user is authenticated
const session = window.localStorage.getItem("session");

if (session) {
  document.getElementById("wiki-feature").style.display = "block"; // Show APSIT-Wiki if authenticated
  document.getElementById("logout-btn").style.display = "block"; // Show logout button
  document.getElementById("profile-btn").style.display = "none"; // Hide "Are you from APSIT?"
} else {
  document.getElementById("wiki-feature").style.display = "none"; // Hide APSIT-Wiki if not authenticated
  document.getElementById("logout-btn").style.display = "none"; // Hide logout button
  document.getElementById("profile-btn").style.display = "block"; // Show "Are you from APSIT?"
}

// Function to handle logout
function logout() {
  // Clear the session from local storage
  window.localStorage.removeItem("session");

  // Redirect the user to signin.html
  window.location.href = "/signin.html";
}

const chatbox = document.getElementById("chatbox");
const userMessageElement = document.getElementById("user-message");
const sendBtn = document.getElementById("send-btn");
const chatbotContainer = document.getElementById("chatbot-container");
const chatbotToggler = document.getElementById("chatbot-toggler");
const closeBtn = document.getElementById("close-btn");

let micActive = false;
const recognition = new (window.SpeechRecognition ||
  window.webkitSpeechRecognition)();
recognition.lang = "en-US";
recognition.interimResults = false;

// Clear chat history on page reload
const loadChatHistory = () => {
  localStorage.removeItem("chatHistory");
  chatbox.innerHTML = ""; // Clear any existing messages
};

const saveChatHistory = () => {
  const messages = [];
  document.querySelectorAll("#chatbox li").forEach((message) => {
    messages.push({
      text: message.innerText,
      type: message.classList.contains("outgoing") ? "outgoing" : "incoming",
      timestamp: message.querySelector(".small.text-muted").innerText,
    });
  });
  localStorage.setItem("chatHistory", JSON.stringify(messages));
};

const addChatMessage = (message, type, timestamp) => {
  const chatMessage = document.createElement("li");
  chatMessage.classList.add("chat", type);
  chatMessage.innerHTML = `<p>${message} <span class="small text-muted" style="color:black">(${timestamp})</span></p>`;
  chatbox.appendChild(chatMessage);
  chatbox.scrollTop = chatbox.scrollHeight;
  saveChatHistory();
};

const sendMessage = (message) => {
  if (!message) return;
  const timestamp = new Date().toLocaleTimeString([], {
    hour: "2-digit",
    minute: "2-digit",
  });
  addChatMessage(message, "outgoing", timestamp);
  handleBotResponse(message);
};

const handleBotResponse = (message) => {
  const typingIndicator = document.createElement("li");
  typingIndicator.classList.add("chat", "incoming");
  typingIndicator.innerHTML = `<div class="typing-indicator"><span class="typing-animation"></span><span class="typing-animation"></span><span class="typing-animation"></span></div>`;
  chatbox.appendChild(typingIndicator);
  chatbox.scrollTop = chatbox.scrollHeight;

  setTimeout(() => {
    chatbox.removeChild(typingIndicator);
    const botResponse = getBotResponse(message);
    const timestamp = new Date().toLocaleTimeString([], {
      hour: "2-digit",
      minute: "2-digit",
    });
    addChatMessage(botResponse, "incoming", timestamp);

    if (!micActive) {
      responsiveVoice.speak(botResponse);
    }
  }, 1000);
};

const getBotResponse = (message) => {
  const responses = {
    hello: "Hello! How can I assist you today?",
    "where is the canteen?":
      "Navigate to the ground floor, enter your current location, and select 'Canteen' as your destination.",
    "where can i find the stationary shop?":
      "Go to the ground floor, input your location, and choose 'Stationary' as your destination.",
    "where is the it faculty room?":
      "Select your current location and set '304D (IT Faculty Room)' as your destination.",
    "how do i reach the hardware workshop for first-year students?":
      "Head to the basement or parking area, enter your location, and mark 'Workshop-1' as your destination.",
    "where is the cafeteria located?":
      "Set your destination to 'Cafeteria-1/-2' and follow the provided directions.",
    "where are the nearest restrooms?":
      "Mark 'Restroom' as your destination and follow the directions provided.",
    "where is the it head of department's room?":
      "Scan for the nearest room, select '318D' as your destination, and follow the blue arrow.",
    "how do i find the main entrance?":
      "The main entrance is indicated by a blue arrow.",
    "is there an elevator nearby?":
      "Select the elevator option and follow the blue path to locate the nearest elevator.",
    "how can i reach the library?":
      "Enter your current location and set your destination to 'Library,' then follow the arrow.",
    "where is the seminar hall?":
      "Select your destination and click the start button to follow the designated path.",
    "how do i get to the reception?":
      "Mark 'Reception' as your destination and follow the path outlined.",
    "where is the principal room?":
      "Set your destination to 'Principal Room,' click the start button, and follow the designated path.",
    "where can i find the boys' common room?":
      "Enter your starting location and set the destination to 'Boys' Common Room,' then follow the path.",
    "how do i reach the physics lab?":
      "Scan for the nearest room, select 'Physics Lab,' and follow the blue arrow.",
    "where is room 304b?":
      "Scan for the nearest room, select '304B,' and follow the blue arrow.",
    "how can i reach the examination cell?":
      "Enter your current location, mark 'Examination Cell' as your destination, and follow the arrow.",
    "where is the music room?":
      "Enter your current location, set your destination to 'Music Room,' and follow the provided path.",
    "how do i report an issue or provide feedback?":
      "You can report issues or provide feedback at the reception desk or by using the feedback form available on the website.",
    "what are the operating hours for the cafeteria?":
      "The cafeteria operates from 8 AM to 8 PM on weekdays. Please check the schedule for weekend hours.",
    "how do i access wi-fi on campus?":
      "Wi-Fi is available throughout the campus. Connect to the network 'Campus Wi-Fi' and use your student credentials to log in.",
    "where is the outdoor seating area?":
      "The outdoor seating area is located in front of the ground floor cafeteria. Follow the path marked 'Cafeteria 2.'",
  };
  return responses[message.toLowerCase()] || "Please visit the Reception";
};

// Handle microphone input
recognition.addEventListener("result", (event) => {
  const transcript = event.results[0][0].transcript;
  sendMessage(transcript);
});

// Send button event listener
sendBtn.addEventListener("click", () => {
  const userMessage = userMessageElement.value;
  userMessageElement.value = "";
  sendMessage(userMessage);
});

// Toggle chatbot display
chatbotToggler.addEventListener("click", () => {
  chatbotContainer.style.display =
    chatbotContainer.style.display === "none" ? "block" : "none";
});

// Close chatbot button
closeBtn.addEventListener("click", () => {
  chatbotContainer.style.display = "none";
});

// Load chat history when the page loads
document.addEventListener("DOMContentLoaded", loadChatHistory);

/* Recommended Topics Feature */

const recommendedTopics = [
  "Where is the canteen?",
  "where can i find the stationary shop?",
  "where is the it faculty room?",
  "How do I reach the hardware workshop for first-year students?",
  "Where is the cafeteria located?",
  "Where are the nearest restrooms?",
  "Where is the IT Head of Department's room?",
  "How do I find the main entrance?",
  "Is there an elevator nearby?",
  "How can I reach the library?",
  "Where is the seminar hall?",
  "How do I get to the reception?",
  "Where is the Principal room?",
  "Where can I find the Boy's common room?",
  "How do I reach the physics lab?",
  "Where is room 304B?",
  "How can I reach the Examination Cell?",
  "Where is the music room?",
  "How do I report an issue or provide feedback?",
  "What are the operating hours for the cafeteria?",
  "How do I access Wi-Fi on campus?",
  "Where is the outdoor seating area?",
];

const topicListElement = document.getElementById("topic-list");
const refreshBtn = document.getElementById("refresh-btn");

const displayRecommendedTopics = () => {
  topicListElement.innerHTML = "";
  const randomTopics = getRandomTopics(3);
  randomTopics.forEach((topic) => {
    const topicElement = document.createElement("li");
    topicElement.textContent = topic;
    topicElement.addEventListener("click", () => {
      // Check if there is a bot response for the topic
      const botResponse = getBotResponse(topic);
      const timestamp = new Date().toLocaleTimeString([], {
        hour: "2-digit",
        minute: "2-digit",
      });
      if (botResponse) {
        addChatMessage(topic, "outgoing", timestamp);
        addChatMessage(botResponse, "incoming", timestamp);
      } else {
        addChatMessage(topic, "outgoing", timestamp);
        addChatMessage("Please visit the Reception", "incoming", timestamp);
      }
    });
    topicListElement.appendChild(topicElement);
  });
};

const getRandomTopics = (count) => {
  const shuffled = recommendedTopics.sort(() => 0.5 - Math.random());
  return shuffled.slice(0, count);
};

// Refresh recommended topics
refreshBtn.addEventListener("click", displayRecommendedTopics);
displayRecommendedTopics();

jQuery(document).ready(function () {
  jQuery(".faq-question").click(function () {
    jQuery(this).next(".faq-answer").toggle();
  });
});

const feedbackForm = document.getElementById("feedback-form");
const feedbackMessage = document.getElementById("feedback-message");

feedbackForm.addEventListener("submit", function (e) {
  e.preventDefault();

  const name = document.getElementById("name").value.trim();
  const email = document.getElementById("email").value.trim();
  const feedbackType = document.getElementById("feedback-type").value;
  const feedbackText = document.getElementById("feedback").value.trim();
  const rating = document.getElementById("rating").value;

  if (name && email && feedbackType && feedbackText && rating) {
    // Simulate form submission
    feedbackMessage.textContent = "Thank you for your feedback, " + name + "!";
    feedbackMessage.style.color = "green";

    // Optionally send the feedback to a server via an API (uncomment to use)
    // submitFeedback(name, email, feedbackType, feedbackText, rating);

    // Reset the form
    feedbackForm.reset();
  } else {
    feedbackMessage.textContent = "Please fill in all fields!";
    feedbackMessage.style.color = "red";
  }
});

// Function to handle API submission (Optional)
function submitFeedback(name, email, feedbackType, feedbackText, rating) {
  const data = {
    name: name,
    email: email,
    feedbackType: feedbackType,
    feedback: feedbackText,
    rating: rating,
  };

  fetch("/submit-feedback", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(data),
  })
    .then((response) => response.json())
    .then((data) => {
      feedbackMessage.textContent = "Thank you for your feedback!";
      feedbackMessage.style.color = "green";
      feedbackForm.reset();
    })
    .catch((error) => {
      feedbackMessage.textContent =
        "Error submitting feedback. Please try again later.";
      feedbackMessage.style.color = "red";
    });
}
  </script>

</body>
</html>
